# Maintainer: paperbenni <paperbenni@gmail.com>
_pkgname=rangerplugins
pkgname=$_pkgname
pkgver=20204210
pkgrel=1
pkgdesc="plugins for ranger file manager"
url="https://github.com/ranger/ranger.git"
arch=('any')
license=('MIT')
depends=('ranger')
makedepends=('git')
provides=(rangerplugins)
conflicts=(rangerplugins)

pkgver() {
    echo "$(date '+%Y%m%d%H%M')"
}

prepare() {
    echo "no prepare"
}

build() {
    echo "no build"
}

package() {
    rm -rf rangerplugins

    mkdir rangerplugins
    cd rangerplugins

    mkdir -p ${pkgdir}/usr/share/rangerplugins

    installplugin() {
        GITREPO=${1#*/}
        echo "installing $GITREPO"
        git clone --depth=1 https://github.com/"$1".git
        mv "$GITREPO"/*.py .
        rm -rf "$GITREPO"/*
        rm -rf "$GITREPO"/.git
        rm -rf "$GITREPO"/.gitignore
        mv *.py "$GITREPO"/
    }

    git clone --depth=1 "https://github.com/alexanderjeurissen/ranger_devicons.git"
    cd ranger_devicons
    mv __init__.py devicons_linemode.py
    mv ./*.py ${pkgdir}/usr/share/rangerplugins/
    cd ..
    rm -rf ranger_devicons

    installplugin laggardkernel/ranger-fzf-marks
    touch ${pkgdir}/usr/share/rangerplugins/__init__.py
    mv ./* ${pkgdir}/usr/share/rangerplugins/
}
